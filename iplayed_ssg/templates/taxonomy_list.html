{% extends "base.html" %}

{%- block title -%}
{{ taxonomy.name | title }} | {{ config.title }}
{%- endblock -%}

{%- block main -%}
{%- set term_count = terms | length -%}
{%- if taxonomy.name is ending_with("ies") -%}
{%- set singular_name = taxonomy.name | replace(from="ies", to="y") -%}
{%- else -%}
{%- set singular_name = taxonomy.name | trim_end_matches(pat="s") -%}
{%- endif -%}

<section class="taxonomy content">
    <header class="taxonomy-header">
        <h1>{{ taxonomy.name | title }}</h1>
        <p class="taxonomy-subtitle">Select a {{ singular_name | default(value="category") }} to explore all
            completions.</p>
    </header>

    {% if term_count > 0 %}
    <section class="taxonomy-search" aria-label="Filter {{ taxonomy.name }}">
        <label class="games-search__label" for="taxonomy-search-input">Search {{ taxonomy.name | title }}</label>
        <input id="taxonomy-search-input" class="games-search__input" type="search" placeholder="Type a name&hellip;"
            autocomplete="off" data-taxonomy-search>
        <p class="taxonomy-search__status" data-taxonomy-search-status data-taxonomy-label="{{ taxonomy.name | escape }}" aria-live="polite">
            Showing {{ term_count }} {{ taxonomy.name }}
        </p>
    </section>

    <div class="taxonomy-grid" data-taxonomy-list>
        {%- for term in terms %}
        {%- set page_count = [term.page_count ~ " game", term.page_count | pluralize] | join %}
        <article class="taxonomy-card" data-taxonomy-card data-search-text="{{ term.name | lower | escape }}">
            <a class="taxonomy-card__link" href="{{ term.permalink | safe }}">
                <span class="taxonomy-card__name">{{ term.name }}</span>
                <span class="taxonomy-card__count">{{ page_count }}</span>
            </a>
        </article>
        {%- endfor %}
    </div>
    {% else %}
    <p class="taxonomy-empty">No {{ taxonomy.name }} yet. Check back later.</p>
    {% endif %}
</section>

<script src="{{ get_url(path="js/taxonomy-search.js", cachebust=true) }}" defer></script>
{%- endblock -%}
